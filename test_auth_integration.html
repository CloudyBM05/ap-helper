<!DOCTYPE html>
<html>
<head>
    <title>Test Socratic Chat Authentication</title>
</head>
<body>
    <h2>Socratic Chat Authentication Test</h2>
    <p>Testing the authentication integration...</p>
    
    <div id="results"></div>
    
    <script>
        // Test 1: Check if the Socratic chat page requires authentication
        fetch('http://localhost:5174/socratic-chat/apush/unit1')
            .then(response => {
                console.log('Frontend response status:', response.status);
                return response.text();
            })
            .then(html => {
                const resultsDiv = document.getElementById('results');
                if (html.includes('Login Required')) {
                    resultsDiv.innerHTML += '<p style="color: green;">✅ Authentication check working - redirects to login when not authenticated</p>';
                } else if (html.includes('Socratic AI tutor')) {
                    resultsDiv.innerHTML += '<p style="color: orange;">⚠️ User appears to be logged in - chat interface loaded</p>';
                } else {
                    resultsDiv.innerHTML += '<p style="color: red;">❌ Unexpected response - check console</p>';
                    console.log('Response HTML:', html.substring(0, 500));
                }
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('results').innerHTML += '<p style="color: red;">❌ Error testing authentication: ' + error.message + '</p>';
            });

        // Test 2: Check if backend API is accessible
        setTimeout(() => {
            fetch('http://localhost:3001/api/chat/send', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ message: 'test' })
            })
            .then(response => {
                console.log('Backend API status:', response.status);
                if (response.ok || response.status === 401 || response.status === 403) {
                    document.getElementById('results').innerHTML += '<p style="color: green;">✅ Backend API is accessible on port 3001</p>';
                } else {
                    document.getElementById('results').innerHTML += '<p style="color: orange;">⚠️ Backend API responded with status: ' + response.status + '</p>';
                }
            })
            .catch(error => {
                console.error('Backend error:', error);
                document.getElementById('results').innerHTML += '<p style="color: red;">❌ Backend API not accessible: ' + error.message + '</p>';
            });
        }, 1000);
    </script>
</body>
</html>
